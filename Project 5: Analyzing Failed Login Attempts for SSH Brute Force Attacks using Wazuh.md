# Analyzing Failed Login Attempts for Brute Force Attacks

## Introduction
SSH (Secure Shell) is a popular protocol used for secure remote access to systems. However, it is also a common target for attackers attempting to gain unauthorized access through brute force attacks. Wazuh is an open-source security monitoring platform that can be used to detect and respond to various security threats, including SSH brute force attacks. In this project, you will learn how to use Wazuh to analyze failed SSH login attempts and identify potential brute force attacks on a Linux system.

## Pre-requisites
- Basic understanding of Linux operating systems and command-line interface.
- Familiarity with SSH protocol and authentication mechanisms.
- Access to a Linux system (physical or virtual) with SSH enabled for conducting exercises.
- Administrative privileges on the Linux system to install and configure Wazuh.

## Lab Set-up
- Linux System: Set up a Linux system (e.g., Ubuntu, CentOS) with SSH enabled for remote access.
- Wazuh: Install Wazuh server and agent on the Linux system to monitor and analyze security events. Follow the official installation guide (https://documentation.wazuh.com/current/installation-guide/index.html) for detailed instructions.
- Wazuh Agent Configuration: Configure the Wazuh agent on the Linux system to forward SSH authentication logs to the Wazuh server for analysis. Ensure that the agent is properly connected to the Wazuh server and sending logs.

## Exercises
Exercise: Detecting SSH Brute Force Attacks with Wazuh

Objective: Use Wazuh to analyze failed SSH login attempts and detect potential brute force attacks on a Linux system.

Scenario: You suspect that an attacker is attempting to gain unauthorized access to your Linux system through SSH brute force attacks. Your task is to configure Wazuh to monitor SSH authentication logs and detect any patterns indicative of brute force attacks.

Step 1: Configure Wazuh to Monitor SSH Logs:

- Access the Wazuh server management interface (Kibana) using a web browser.
- Navigate to the "Configuration" tab and edit the Wazuh agent configuration file (/var/ossec/etc/ossec.conf).
- Add a new log collection rule to monitor SSH authentication logs (/var/log/auth.log on Debian/Ubuntu or /var/log/secure on CentOS/RHEL):
```
<localfile>
  <log_format>syslog</log_format>
  <location>/var/log/auth.log</location>
</localfile>
```
- Save the changes and restart the Wazuh agent service to apply the configuration.

Step 2: Simulate Failed SSH Login Attempts:

- Use a tool like sshguard or fail2ban to simulate failed SSH login attempts from a remote IP address.
- Generate a series of failed login attempts by attempting to SSH into the Linux system with incorrect credentials multiple times.

Step 3: Monitor Wazuh Alerts:

- Access the Wazuh server management interface (Kibana) and navigate to the "Detection" tab.
- Look for alerts related to failed SSH login attempts generated by Wazuh.
- Pay attention to the severity level, source IP address, and frequency of failed login attempts in the alerts.

Step 4: Analyze Wazuh Alerts:

- Click on the alerts to view detailed information about the failed SSH login attempts.
- Analyze the source IP addresses, usernames, and timestamps of the failed login attempts.
- Look for patterns or anomalies in the authentication logs that may indicate a brute force attack, such as repeated login attempts from the same IP address or multiple failed logins within a short time frame.

Step 5: Take Response Actions:

- If the Wazuh alerts confirm the presence of a brute force attack, take appropriate response actions to mitigate the threat.
- Consider blocking the source IP addresses using firewall rules, temporarily disabling SSH access, or implementing stronger authentication mechanisms (e.g., SSH key-based authentication).

## Conclusion:

- If Wazuh generates alerts for failed SSH login attempts from the same IP address or multiple failed logins within a short time frame, it indicates a potential brute force attack. Take immediate action to block the source IP address and strengthen the security posture of the Linux system.
- If Wazuh alerts do not detect any suspicious patterns or failed login attempts, continue monitoring the system for any further signs of unauthorized access and consider implementing additional security measures to protect against brute force attacks.
By completing this exercise, you'll gain practical experience in using Wazuh to detect and respond to SSH brute force attacks, enhancing the security of your Linux systems.







